[{
  "name": "should respect record_sql policy",
  "required_features": ["record_sql"],
  "starting_policy_settings": {
    "record_sql": {"enabled": false}
  },
  "security_policies": {
    "record_sql": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "record_sql": {"enabled": true}
  },
  "ending_policy_settings": {
    "record_sql": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect attributes_include policy",
  "required_features": ["attributes_include"],
  "starting_policy_settings": {
    "attributes_include": {"enabled": false}
  },
  "security_policies": {
    "attributes_include": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "attributes_include": {"enabled": true}
  },
  "ending_policy_settings": {
    "attributes_include": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect strip_exception_messages policy",
  "required_features": ["strip_exception_messages"],
  "starting_policy_settings": {
    "strip_exception_messages": {"enabled": false}
  },
  "security_policies": {
    "strip_exception_messages": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "strip_exception_messages": {"enabled": true}
  },
  "ending_policy_settings": {
    "strip_exception_messages": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect custom_events policy",
  "required_features": ["custom_events"],
  "starting_policy_settings": {
    "custom_events": {"enabled": false}
  },
  "security_policies": {
    "custom_events": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "custom_events": {"enabled": true}
  },
  "ending_policy_settings": {
    "custom_events": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect request_parameters policy",
  "required_features": ["request_parameters"],
  "starting_policy_settings": {
    "request_parameters": {"enabled": false}
  },
  "security_policies": {
    "request_parameters": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "request_parameters": {"enabled": true}
  },
  "ending_policy_settings": {
    "request_parameters": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect custom_parameters policy",
  "required_features": ["custom_parameters"],
  "starting_policy_settings": {
    "custom_parameters": {"enabled": false}
  },
  "security_policies": {
    "custom_parameters": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "custom_parameters": {"enabled": true}
  },
  "ending_policy_settings": {
    "custom_parameters": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect custom_instrumentation_editor policy",
  "required_features": ["custom_instrumentation_editor"],
  "starting_policy_settings": {
    "custom_instrumentation_editor": {"enabled": false}
  },
  "security_policies": {
    "custom_instrumentation_editor": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "custom_instrumentation_editor": {"enabled": true}
  },
  "ending_policy_settings": {
    "custom_instrumentation_editor": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect message_parameters policy",
  "required_features": ["message_parameters"],
  "starting_policy_settings": {
    "message_parameters": {"enabled": false}
  },
  "security_policies": {
    "message_parameters": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "message_parameters": {"enabled": true}
  },
  "ending_policy_settings": {
    "message_parameters": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should respect job_arguments policy",
  "required_features": ["job_arguments"],
  "starting_policy_settings": {
    "job_arguments": {"enabled": false}
  },
  "security_policies": {
    "job_arguments": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "job_arguments": {"enabled": true}
  },
  "ending_policy_settings": {
    "job_arguments": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should only respond with listed policies",
  "required_features": ["record_sql", "attributes_include"],
  "starting_policy_settings": {
    "record_sql": {"enabled": true},
    "attributes_include": {"enabled": true}
  },
  "security_policies": {
    "record_sql": {"enabled": false, "required": false}
  },
  "expected_connect_policies": {
    "record_sql": {"enabled": false}
  },
  "ending_policy_settings": {
    "record_sql": {"enabled": false},
    "attributes_include": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should not respond with unknown policies",
  "required_features": ["record_sql"],
  "starting_policy_settings": {
    "record_sql": {"enabled": false}
  },
  "security_policies": {
    "record_sql": {"enabled": true, "required": false},
    "some_new_feature": {"enabled": true, "required": false}
  },
  "expected_connect_policies": {
    "record_sql": {"enabled": true}
  },
  "ending_policy_settings": {
    "record_sql": {"enabled": true}
  },
  "should_log": false,
  "should_shutdown": false
}, {
  "name": "should shutdown for required but unknown policies",
  "required_features": ["record_sql"],
  "starting_policy_settings": {
    "record_sql": {"enabled": false}
  },
  "security_policies": {
    "record_sql": {"enabled": true, "required": false},
    "some_new_feature": {"enabled": true, "required": true}
  },
  "expected_connect_policies": {
    "record_sql": {"enabled": true}
  },
  "ending_policy_settings": {
    "record_sql": {"enabled": true}
  },
  "should_log": true,
  "should_shutdown": true
}]
